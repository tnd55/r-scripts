axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
# ── packages ────────────────────────────────────────────────────────────────
library(tidyverse)    # ggplot2, readr, dplyr, …
library(conflicted)   # optional – resolves function name clashes
library(patchwork)    # if you later want multi-panel layouts
library(scales)       # for axis label helpers
# ── data ────────────────────────────────────────────────────────────────────
raw <- read_csv("MgQE_progesterone.csv")   # readr is faster / safer than base read.csv
# ── helper utilities (put these in a separate file like theme_pub.R if you wish) ──
## readable scientific formatter: 1.6 × 10^5
sci_format <- function(x) {
formatted <- scientific_format()(x)
formatted[x == 0] <- "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))
}
## publication theme
theme_pub <- function(base_size = 14, base_family = "Arial") {
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
# Remove default backgrounds for a clean look
panel.background = element_blank(),
plot.background  = element_blank(),
# Draw a black box around the plot area
#panel.border     = element_rect(color = "black", fill = NA, linewidth = 1),
# Draw axis lines with specified color and thickness
axis.line        = element_line(color = "black", linewidth = 1),
# Show axis ticks in black with specified thickness
axis.ticks       = element_line(color = "black", linewidth = 1),
# Set tick length and make ticks point outward
axis.ticks.length    = unit(0.25, "cm"),
axis.ticks.direction = "out",
# Remove grid lines for a clean, publication-ready look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Position legend inside plot, remove legend background and title
legend.position   = c(0.87, 0.85),
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
# Customize text sizes for axes, legend, and plot title
axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
# ── packages ────────────────────────────────────────────────────────────────
library(tidyverse)    # ggplot2, readr, dplyr, …
library(conflicted)   # optional – resolves function name clashes
library(patchwork)    # if you later want multi-panel layouts
library(scales)       # for axis label helpers
# ── data ────────────────────────────────────────────────────────────────────
raw <- read_csv("MgQE_progesterone.csv")   # readr is faster / safer than base read.csv
# ── helper utilities (put these in a separate file like theme_pub.R if you wish) ──
## readable scientific formatter: 1.6 × 10^5
sci_format <- function(x) {
formatted <- scientific_format()(x)
formatted[x == 0] <- "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))
}
## publication theme
theme_pub <- function(base_size = 14, base_family = "Arial") {
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
# Remove default backgrounds for a clean look
panel.background = element_blank(),
plot.background  = element_blank(),
# Draw a black box around the plot area
#panel.border     = element_rect(color = "black", fill = NA, linewidth = 1),
# Draw axis lines with specified color and thickness
axis.line        = element_line(color = "black", linewidth = 1),
# Show axis ticks in black with specified thickness
axis.ticks       = element_line(color = "black", linewidth = 1),
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# Set tick length and make ticks point outward
axis.ticks.length    = unit(0.25, "cm"),
axis.ticks.direction = "out",
# Remove grid lines for a clean, publication-ready look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Position legend inside plot, remove legend background and title
legend.position   = c(0.87, 0.85),
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
# Customize text sizes for axes, legend, and plot title
axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
# ── packages ────────────────────────────────────────────────────────────────
library(tidyverse)    # ggplot2, readr, dplyr, …
library(conflicted)   # optional – resolves function name clashes
library(patchwork)    # if you later want multi-panel layouts
library(scales)       # for axis label helpers
# ── data ────────────────────────────────────────────────────────────────────
raw <- read_csv("MgQE_progesterone.csv")   # readr is faster / safer than base read.csv
# ── helper utilities (put these in a separate file like theme_pub.R if you wish) ──
## readable scientific formatter: 1.6 × 10^5
sci_format <- function(x) {
formatted <- scientific_format()(x)
formatted[x == 0] <- "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))
}
## publication theme
theme_pub <- function(base_size = 14, base_family = "Arial") {
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
# Remove default backgrounds for a clean look
panel.background = element_blank(),
plot.background  = element_blank(),
# Draw a black box around the plot area
#panel.border     = element_rect(color = "black", fill = NA, linewidth = 1),
# Draw axis lines with specified color and thickness
axis.line        = element_line(color = "black", linewidth = 1),
# Show axis ticks in black with specified thickness
axis.ticks       = element_line(color = "black", linewidth = 1),
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# Set tick length and make ticks point outward
axis.ticks.length    = unit(0.25, "cm"),
axis.ticks.direction = "out",
# Remove grid lines for a clean, publication-ready look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Position legend inside plot, remove legend background and title
legend.position   = c(0.87, 0.85),
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
# Customize text sizes for axes, legend, and plot title
axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time (min)", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
# ── packages ────────────────────────────────────────────────────────────────
library(tidyverse)    # ggplot2, readr, dplyr, …
library(conflicted)   # optional – resolves function name clashes
library(patchwork)    # if you later want multi-panel layouts
library(scales)       # for axis label helpers
# ── data ────────────────────────────────────────────────────────────────────
raw <- read_csv("MgQE_progesterone.csv")   # readr is faster / safer than base read.csv
# ── helper utilities (put these in a separate file like theme_pub.R if you wish) ──
## readable scientific formatter: 1.6 × 10^5
sci_format <- function(x) {
formatted <- scientific_format()(x)
formatted[x == 0] <- "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))
}
## publication theme
theme_pub <- function(base_size = 14, base_family = "Arial") {
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
# Remove default backgrounds for a clean look
panel.background = element_blank(),
plot.background  = element_blank(),
# Draw a black box around the plot area
#panel.border     = element_rect(color = "black", fill = NA, linewidth = 1),
# Draw axis lines with specified color and thickness
axis.line        = element_line(color = "black", linewidth = 1),
# Show axis ticks in black with specified thickness
axis.ticks       = element_line(color = "black", linewidth = 1),
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# Set tick length and make ticks point outward
axis.ticks.length    = unit(0.25, "cm"),
axis.ticks.direction = "out",
# Remove grid lines for a clean, publication-ready look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Position legend inside plot, remove legend background and title
legend.position   = c(0.87, 0.85),
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
# Customize text sizes for axes, legend, and plot title
axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time (min)", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), breaks = seq(0, 160000, by = 40000), expand = c(0,0), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
# ── packages ────────────────────────────────────────────────────────────────
library(tidyverse)    # ggplot2, readr, dplyr, …
library(conflicted)   # optional – resolves function name clashes
library(patchwork)    # if you later want multi-panel layouts
library(scales)       # for axis label helpers
# ── data ────────────────────────────────────────────────────────────────────
raw <- read_csv("MgQE_progesterone.csv")   # readr is faster / safer than base read.csv
# ── helper utilities (put these in a separate file like theme_pub.R if you wish) ──
## readable scientific formatter: 1.6 × 10^5
sci_format <- function(x) {
formatted <- scientific_format()(x)
formatted[x == 0] <- "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))
}
## publication theme
theme_pub <- function(base_size = 14, base_family = "Arial") {
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
# Remove default backgrounds for a clean look
panel.background = element_blank(),
plot.background  = element_blank(),
# Draw a black box around the plot area
panel.border     = element_rect(color = "black", fill = NA, linewidth = 1),
# Draw axis lines with specified color and thickness
axis.line        = element_line(color = "black", linewidth = 1),
# Show axis ticks in black with specified thickness
axis.ticks       = element_line(color = "black", linewidth = 1),
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# Set tick length and make ticks point outward
axis.ticks.length    = unit(0.25, "cm"),
axis.ticks.direction = "out",
# Remove grid lines for a clean, publication-ready look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Position legend inside plot, remove legend background and title
legend.position   = c(0.87, 0.85),
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
# Customize text sizes for axes, legend, and plot title
axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time (min)", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), breaks = seq(0, 160000, by = 40000), expand = c(0,0), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
# ── packages ────────────────────────────────────────────────────────────────
library(tidyverse)    # ggplot2, readr, dplyr, …
library(conflicted)   # optional – resolves function name clashes
library(patchwork)    # if you later want multi-panel layouts
library(scales)       # for axis label helpers
# ── data ────────────────────────────────────────────────────────────────────
raw <- read_csv("MgQE_progesterone.csv")   # readr is faster / safer than base read.csv
# ── helper utilities (put these in a separate file like theme_pub.R if you wish) ──
## readable scientific formatter: 1.6 × 10^5
sci_format <- function(x) {
formatted <- scientific_format()(x)
formatted[x == 0] <- "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))
}
## publication theme
theme_pub <- function(base_size = 14, base_family = "Arial") {
theme_minimal(base_size = base_size, base_family = base_family) +
theme(
# Remove default backgrounds for a clean look
panel.background = element_blank(),
plot.background  = element_blank(),
# Draw a black box around the plot area
#panel.border     = element_rect(color = "black", fill = NA, linewidth = 1),
# Draw axis lines with specified color and thickness
axis.line        = element_line(color = "black", linewidth = 1),
# Show axis ticks in black with specified thickness
axis.ticks       = element_line(color = "black", linewidth = 1),
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# Set tick length and make ticks point outward
axis.ticks.length    = unit(0.25, "cm"),
axis.ticks.direction = "out",
# Remove grid lines for a clean, publication-ready look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Position legend inside plot, remove legend background and title
legend.position   = c(0.87, 0.85),
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
# Customize text sizes for axes, legend, and plot title
axis.text   = element_text(size = base_size),
axis.title  = element_text(size = base_size * 1.2),
legend.text = element_text(size = base_size),
plot.title  = element_text(size = base_size * 1.4, face = "bold")
)
}
# ── plot ────────────────────────────────────────────────────────────────────
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +
labs(x = "Retention time (min)", y = "Intensity") +
scale_x_continuous(expand = c(0, 0), limits = c(15, 30)) +
scale_y_continuous(limits = c(0, 160000), breaks = seq(0, 160000, by = 40000), expand = c(0,0), labels = sci_format) +
theme_pub()
# ── view or save ────────────────────────────────────────────────────────────
print(final)
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
#######################################################################
##  PACKAGES  ─────────────────────────────────────────────────────────
#######################################################################
library(tidyverse)   # ggplot2, readr, dplyr, …
library(conflicted)  # optional—helps resolve naming clashes
library(patchwork)   # for multi-panel layouts (future use)
library(scales)      # nice axis-label helpers
#######################################################################
##  DATA  ─────────────────────────────────────────────────────────────
#######################################################################
# Read the raw chromatogram data
raw <- read_csv("MgQE_progesterone.csv")
#######################################################################
##  HELPER FUNCTIONS  ────────────────────────────────────────────────
#######################################################################
# ── 1. Scientific-notation formatter (e.g. 1.6 × 10^5) ──────────────
sci_format <- function(x) {
formatted <- scientific_format()(x)               # "1.6e+05"
formatted[x == 0] <- "0"                          # keep exact zero as "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))# convert to 1.6 × 10^5
}
# ── 2. Publication theme (clean, boxed, no grid)  ───────────────────
theme_pub <- function(base_size   = 14,
base_family = "Arial") {
theme_minimal(base_size = base_size,
base_family = base_family) +
theme(
# ★ Plot & panel backgrounds (blank = no grey fill)
panel.background = element_blank(),
plot.background  = element_blank(),
# ★ Axis box & lines
axis.line   = element_line(color = "black", linewidth = 1),
# If you prefer a full rectangle border around the panel, uncomment ↓
# panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
# ★ Tick marks
axis.ticks        = element_line(color = "black", linewidth = 1),
axis.ticks.length = unit(0.25, "cm"),  # tick length
axis.ticks.direction = "out",          # point ticks outward
# ★ Tick-label text (size & color)
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# ★ Remove grid lines for a clean look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# ★ Legend: inside plot, frameless, no title
legend.position   = c(0.87, 0.85),     # (x, y) in [0,1] plot coords
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = base_size),
# ★ Axis titles & plot title
axis.title = element_text(size = base_size * 1.2),
plot.title = element_text(size = base_size * 1.4, face = "bold")
)
}
#######################################################################
##  PLOT  ────────────────────────────────────────────────────────────
#######################################################################
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +                                   # data line
labs(x = "Retention time (min)", y = "Intensity") +          # axis titles
scale_x_continuous(                                          # X-axis
limits = c(15, 30),
expand = c(0, 0)                                           # no padding
) +
scale_y_continuous(                                          # Y-axis
limits  = c(0, 160000),
breaks  = seq(0, 160000, by = 40000),                      # nice ticks
expand  = c(0, 0),
labels  = sci_format
) +
theme_pub()                                                  # apply theme
#######################################################################
##  SAVE / VIEW  ─────────────────────────────────────────────────────
#######################################################################
print(final)  # View in RStudio
# Uncomment to save publication-quality PDF
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
#######################################################################
##  PACKAGES  ─────────────────────────────────────────────────────────
#######################################################################
library(tidyverse)   # ggplot2, readr, dplyr, …
library(conflicted)  # optional—helps resolve naming clashes
library(patchwork)   # for multi-panel layouts (future use)
library(scales)      # nice axis-label helpers
#######################################################################
##  DATA  ─────────────────────────────────────────────────────────────
#######################################################################
# Read the raw chromatogram data
raw <- read_csv("MgQE_progesterone.csv")
#######################################################################
##  HELPER FUNCTIONS  ────────────────────────────────────────────────
#######################################################################
# ── 1. Scientific-notation formatter (e.g. 1.6 × 10^5) ──────────────
sci_format <- function(x) {
formatted <- scientific_format()(x)               # "1.6e+05"
formatted[x == 0] <- "0"                          # keep exact zero as "0"
parse(text = gsub("e\\+?", " %*% 10^", formatted))# convert to 1.6 × 10^5
}
# ── 2. Publication theme (clean, boxed, no grid)  ───────────────────
theme_pub <- function(base_size   = 14,
base_family = "Arial") {
theme_minimal(base_size = base_size,
base_family = base_family) +
theme(
# ★ Plot & panel backgrounds (blank = no grey fill)
panel.background = element_blank(),
plot.background  = element_blank(),
# ★ Axis box & lines
axis.line   = element_line(color = "black", linewidth = 1),
# If you prefer a full rectangle border around the panel, uncomment ↓
# panel.border = element_rect(color = "black", fill = NA, linewidth = 1),
# ★ Tick marks
axis.ticks        = element_line(color = "black", linewidth = 1),
axis.ticks.length = unit(0.25, "cm"),  # tick length
axis.ticks.direction = "out",          # point ticks outward
# ★ Tick-label text (size & color)
axis.text.x = element_text(color = "black", size = base_size),
axis.text.y = element_text(color = "black", size = base_size),
# ★ Remove grid lines for a clean look
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# ★ Legend: inside plot, frameless, no title
legend.position   = c(0.87, 0.85),     # (x, y) in [0,1] plot coords
legend.background = element_blank(),
legend.key        = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = base_size),
# ★ Axis titles & plot title
axis.title = element_text(size = base_size * 1.2),
plot.title = element_text(size = base_size * 1.4, face = "bold")
)
}
#######################################################################
##  PLOT  ────────────────────────────────────────────────────────────
#######################################################################
final <- ggplot(raw, aes(time, intensity, colour = type, group = type)) +
geom_line(linewidth = 1) +                                   # data line
labs(x = "Retention time (min)", y = "Intensity") +          # axis titles
scale_x_continuous(                                          # X-axis
limits = c(15, 30),
expand = c(0, 0)                                           # no padding
) +
scale_y_continuous(                                          # Y-axis
limits  = c(0, 160000),
breaks  = seq(0, 160000, by = 40000),                      # nice ticks
expand  = c(0, 0),
labels  = sci_format
) +
theme_pub()                                                  # apply theme
#######################################################################
##  SAVE / VIEW  ─────────────────────────────────────────────────────
#######################################################################
print(final)  # View in RStudio
# Uncomment to save publication-quality PDF
# ggsave("figures/progesterone_plot.pdf", final, width = 6, height = 4)
